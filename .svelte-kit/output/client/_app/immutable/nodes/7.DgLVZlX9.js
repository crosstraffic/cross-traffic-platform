import{s as bn,r as mn,o as yn,i as Zt}from"../chunks/scheduler.DLmczG9q.js";import{S as wn,i as En,e as c,s as y,v as Pt,a as d,j as C,g as M,c as w,d as v,w as St,b as h,z as Cn,f as Ie,A as r,x as kt,B as ce,C as Bn,t as se,m as It,k as fe,D as me,y as Ht,o as lt,p as st,n as In,q as fn,r as xt}from"../chunks/index.BCS5BNVK.js";import{component as xn}from"./4.B9BK_bom.js";import{component as Tn}from"./5.DWFFtCGF.js";import{component as Ln}from"./3.DjFQNmzY.js";import{_ as Pn}from"../chunks/@vite-plugin-wasm-pack@HCM-middleware.CNXUF2vc.js";function F(o){return(o==null?void 0:o.length)!==void 0?o:Array.from(o)}function Sn(){return window.crypto.getRandomValues(new Uint32Array(1))[0]}function Tt(o,e=!1){const n=Sn(),t=`_${n}`;return Object.defineProperty(window,t,{value:a=>(e&&Reflect.deleteProperty(window,t),o==null?void 0:o(a)),writable:!1,configurable:!0}),n}async function kn(o,e={}){return new Promise((n,t)=>{const a=Tt(P=>{n(P),Reflect.deleteProperty(window,`_${m}`)},!0),m=Tt(P=>{t(P),Reflect.deleteProperty(window,`_${a}`)},!0);window.__TAURI_IPC__({cmd:o,callback:a,error:m,...e})})}async function Lt(o){return kn("tauri",o)}async function Hn(o,e,n=[],t){return typeof n=="object"&&Object.freeze(n),Lt({__tauriModule:"Shell",message:{cmd:"execute",program:e,args:n,options:t,onEventFn:Tt(o)}})}class Bt{constructor(){this.eventListeners=Object.create(null)}addListener(e,n){return this.on(e,n)}removeListener(e,n){return this.off(e,n)}on(e,n){return e in this.eventListeners?this.eventListeners[e].push(n):this.eventListeners[e]=[n],this}once(e,n){const t=(...a)=>{this.removeListener(e,t),n(...a)};return this.addListener(e,t)}off(e,n){return e in this.eventListeners&&(this.eventListeners[e]=this.eventListeners[e].filter(t=>t!==n)),this}removeAllListeners(e){return e?delete this.eventListeners[e]:this.eventListeners=Object.create(null),this}emit(e,...n){if(e in this.eventListeners){const t=this.eventListeners[e];for(const a of t)a(...n);return!0}return!1}listenerCount(e){return e in this.eventListeners?this.eventListeners[e].length:0}prependListener(e,n){return e in this.eventListeners?this.eventListeners[e].unshift(n):this.eventListeners[e]=[n],this}prependOnceListener(e,n){const t=(...a)=>{this.removeListener(e,t),n(...a)};return this.prependListener(e,t)}}class An{constructor(e){this.pid=e}async write(e){return Lt({__tauriModule:"Shell",message:{cmd:"stdinWrite",pid:this.pid,buffer:typeof e=="string"?e:Array.from(e)}})}async kill(){return Lt({__tauriModule:"Shell",message:{cmd:"killChild",pid:this.pid}})}}class At extends Bt{constructor(e,n=[],t){super(),this.stdout=new Bt,this.stderr=new Bt,this.program=e,this.args=typeof n=="string"?[n]:n,this.options=t??{}}static sidecar(e,n=[],t){const a=new At(e,n,t);return a.options.sidecar=!0,a}async spawn(){return Hn(e=>{switch(e.event){case"Error":this.emit("error",e.payload);break;case"Terminated":this.emit("close",e.payload);break;case"Stdout":this.stdout.emit("data",e.payload);break;case"Stderr":this.stderr.emit("data",e.payload);break}},this.program,this.args,this.options).then(e=>new An(e))}async execute(){return new Promise((e,n)=>{this.on("error",n);const t=[],a=[];this.stdout.on("data",m=>{t.push(m)}),this.stderr.on("data",m=>{a.push(m)}),this.on("close",m=>{e({code:m.code,signal:m.signal,stdout:t.join(`
`),stderr:a.join(`
`)})}),this.spawn().catch(n)})}}function Yt(o,e,n){const t=o.slice();return t[17]=e[n],t}function Gt(o,e,n){const t=o.slice();return t[17]=e[n],t}function Kt(o,e,n){const t=o.slice();return t[17]=e[n],t}function Qt(o,e,n){const t=o.slice();return t[17]=e[n],t}function Xt(o,e,n){const t=o.slice();return t[17]=e[n],t}function en(o,e,n){const t=o.slice();return t[17]=e[n],t}function tn(o,e,n){const t=o.slice();return t[17]=e[n],t}function nn(o,e,n){const t=o.slice();return t[32]=e[n],t}function ln(o,e,n){const t=o.slice();return t[17]=e[n],t}function sn(o){let e,n;return e=new xn({props:{seg_num:o[17].seg_num,subseg_num:o[17].subrows.length,changeSegment:_n,changeHC:o[5],toggleHCParams:o[4]}}),{c(){Pt(e.$$.fragment)},l(t){St(e.$$.fragment,t)},m(t,a){kt(e,t,a),n=!0},p(t,a){const m={};a[0]&1&&(m.seg_num=t[17].seg_num),a[0]&1&&(m.subseg_num=t[17].subrows.length),e.$set(m)},i(t){n||(se(e.$$.fragment,t),n=!0)},o(t){fe(e.$$.fragment,t),n=!1},d(t){Ht(e,t)}}}function on(o){let e,n;return e=new Tn({props:{subseg_num:o[32].subseg_num}}),{c(){Pt(e.$$.fragment)},l(t){St(e.$$.fragment,t)},m(t,a){kt(e,t,a),n=!0},p(t,a){const m={};a[0]&1&&(m.subseg_num=t[32].subseg_num),e.$set(m)},i(t){n||(se(e.$$.fragment,t),n=!0)},o(t){fe(e.$$.fragment,t),n=!1},d(t){Ht(e,t)}}}function rn(o){let e,n,t,a,m,P,Y,Z=o[17].seg_num+"",oe,de,k,re="<th>Subsegment</th> <th>Length</th> <th>Design Radius</th> <th>Superelevation</th>",G,j,_e,K,R,i="Add",E,b,H="Remove",$,_,V,p,A,I=F(o[17].subrows),u=[];for(let T=0;T<I.length;T+=1)u[T]=on(nn(o,I,T));const he=T=>fe(u[T],1,1,()=>{u[T]=null});return{c(){e=c("div"),n=c("div"),t=c("table"),a=c("thead"),m=c("caption"),P=c("b"),Y=lt("Segment "),oe=lt(Z),de=y(),k=c("tr"),k.innerHTML=re,G=y(),j=c("tbody");for(let T=0;T<u.length;T+=1)u[T].c();_e=y(),K=c("div"),R=c("button"),R.textContent=i,E=y(),b=c("button"),b.textContent=H,$=y(),this.h()},l(T){e=d(T,"DIV",{class:!0,id:!0,style:!0});var x=C(e);n=d(x,"DIV",{class:!0});var S=C(n);t=d(S,"TABLE",{class:!0});var ee=C(t);a=d(ee,"THEAD",{});var Q=C(a);m=d(Q,"CAPTION",{class:!0});var qe=C(m);P=d(qe,"B",{});var xe=C(P);Y=st(xe,"Segment "),oe=st(xe,Z),xe.forEach(v),qe.forEach(v),de=w(Q),k=d(Q,"TR",{"data-svelte-h":!0}),M(k)!=="svelte-sbjh6j"&&(k.innerHTML=re),Q.forEach(v),G=w(ee),j=d(ee,"TBODY",{});var ie=C(j);for(let te=0;te<u.length;te+=1)u[te].l(ie);ie.forEach(v),_e=w(ee),K=d(ee,"DIV",{class:!0});var pe=C(K);R=d(pe,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),M(R)!=="svelte-3w0114"&&(R.textContent=i),E=w(pe),b=d(pe,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),M(b)!=="svelte-1bm910w"&&(b.textContent=H),pe.forEach(v),ee.forEach(v),S.forEach(v),$=w(x),x.forEach(v),this.h()},h(){h(m,"class","flex justify-start"),h(R,"class","btn btn-outline btn-sm"),h(R,"type","button"),h(b,"class","btn btn-outline btn-sm"),h(b,"type","button"),h(K,"class","flex justify-end"),h(t,"class","table table-compact"),h(n,"class","card-body"),h(e,"class","hc_table overflow-x-auto card card-compact w-full bg-base-100 shadow-xl"),h(e,"id",_="hc_table"+o[17].seg_num),In(e,"display","none")},m(T,x){Ie(T,e,x),r(e,n),r(n,t),r(t,a),r(a,m),r(m,P),r(P,Y),r(P,oe),r(a,de),r(a,k),r(t,G),r(t,j);for(let S=0;S<u.length;S+=1)u[S]&&u[S].m(j,null);r(t,_e),r(t,K),r(K,R),r(K,E),r(K,b),r(e,$),V=!0,p||(A=[ce(R,"click",function(){Zt(o[6](o[17].seg_num))&&o[6](o[17].seg_num).apply(this,arguments)}),ce(b,"click",function(){Zt(o[7](o[17].seg_num))&&o[7](o[17].seg_num).apply(this,arguments)})],p=!0)},p(T,x){if(o=T,(!V||x[0]&1)&&Z!==(Z=o[17].seg_num+"")&&fn(oe,Z),x[0]&1){I=F(o[17].subrows);let S;for(S=0;S<I.length;S+=1){const ee=nn(o,I,S);u[S]?(u[S].p(ee,x),se(u[S],1)):(u[S]=on(ee),u[S].c(),se(u[S],1),u[S].m(j,null))}for(xt(),S=I.length;S<u.length;S+=1)he(S);It()}(!V||x[0]&1&&_!==(_="hc_table"+o[17].seg_num))&&h(e,"id",_)},i(T){if(!V){for(let x=0;x<I.length;x+=1)se(u[x]);V=!0}},o(T){u=u.filter(Boolean);for(let x=0;x<u.length;x+=1)fe(u[x]);V=!1},d(T){T&&v(e),me(u,T),p=!1,mn(A)}}}function an(o){let e,n,t=o[17].seg_num+"",a;return{c(){e=c("th"),n=lt("Segment "),a=lt(t)},l(m){e=d(m,"TH",{});var P=C(e);n=st(P,"Segment "),a=st(P,t),P.forEach(v)},m(m,P){Ie(m,e,P),r(e,n),r(e,a)},p(m,P){P[0]&1&&t!==(t=m[17].seg_num+"")&&fn(a,t)},d(m){m&&v(e)}}}function un(o){let e,n;return{c(){e=c("td"),this.h()},l(t){e=d(t,"TD",{id:!0}),C(e).forEach(v),this.h()},h(){h(e,"id",n="ffs"+o[17].seg_num)},m(t,a){Ie(t,e,a)},p(t,a){a[0]&1&&n!==(n="ffs"+t[17].seg_num)&&h(e,"id",n)},d(t){t&&v(e)}}}function cn(o){let e,n;return{c(){e=c("td"),this.h()},l(t){e=d(t,"TD",{id:!0}),C(e).forEach(v),this.h()},h(){h(e,"id",n="avgspd"+o[17].seg_num)},m(t,a){Ie(t,e,a)},p(t,a){a[0]&1&&n!==(n="avgspd"+t[17].seg_num)&&h(e,"id",n)},d(t){t&&v(e)}}}function dn(o){let e,n;return{c(){e=c("td"),this.h()},l(t){e=d(t,"TD",{id:!0}),C(e).forEach(v),this.h()},h(){h(e,"id",n="pf"+o[17].seg_num)},m(t,a){Ie(t,e,a)},p(t,a){a[0]&1&&n!==(n="pf"+t[17].seg_num)&&h(e,"id",n)},d(t){t&&v(e)}}}function hn(o){let e,n;return{c(){e=c("td"),this.h()},l(t){e=d(t,"TD",{id:!0}),C(e).forEach(v),this.h()},h(){h(e,"id",n="fd"+o[17].seg_num)},m(t,a){Ie(t,e,a)},p(t,a){a[0]&1&&n!==(n="fd"+t[17].seg_num)&&h(e,"id",n)},d(t){t&&v(e)}}}function gn(o){let e,n;return{c(){e=c("td"),this.h()},l(t){e=d(t,"TD",{id:!0}),C(e).forEach(v),this.h()},h(){h(e,"id",n="seglos"+o[17].seg_num)},m(t,a){Ie(t,e,a)},p(t,a){a[0]&1&&n!==(n="seglos"+t[17].seg_num)&&h(e,"id",n)},d(t){t&&v(e)}}}function Dn(o){let e,n,t="HCM Calulator Chap15",a,m,P="JSON Input",Y,Z,oe,de,k,re,G,j,_e="<tr><th>Segment</th> <th>Passing Type</th> <th>Length</th> <th>Grade</th> <th>Posted Speed Limit</th> <th>Horizontal Curves</th> <th>Horizontal Params</th> <th>Demand Volume</th> <th>Demand Volume (O)</th> <th>Vertical Class</th> <th>Peak Hour Factor</th> <th>Heavy Vehicle Per.</th></tr>",K,R,i,E,b,H='<table class="table w-full"><tbody><tr><td style="display: inline-block;">Lane Width (ft):</td> <td><input type="text" id="LW_input" placeholder="Type here" class="input-label input w-full max-w-xs" value="12" pattern="[+]?([0-9]*([.][0-9]*)|[1-9]|[1-9][0-9])$" autocomplete="off" required=""/></td></tr> <tr><td style="display: inline-block;">Shoulder Width (ft):</td> <td><input type="text" id="SW_input" placeholder="Type here" class="input-label input w-full max-w-xs" value="6" pattern="[+]?([0-9]*([.][0-9]*)|[1-9]|[1-9][0-9])$" autocomplete="off" required=""/></td></tr> <tr><td style="display: inline-block;">Access Point Density (access points/mi):</td> <td><input type="text" id="APD_input" placeholder="Type here" class="input-label input w-full max-w-xs" value="2" pattern="[+]?([0-9]|[0-9]*([.][0-9]*)|[1-9]|[1-9][0-9])$" autocomplete="off" required=""/></td></tr> <tr><td style="display: inline-block;">Percentage Multiplier for <br/> Heavy Vehicles in the Faster / Passing Lane: <br/>*Used only when Passing Lane included</td> <td><input type="text" id="PMHVFL_input" placeholder="Type here" class="input-label input w-full max-w-xs" value="0" pattern="[+]?([0-9]|[0-9]*([.][0-9]*)|[1-9]|[1-9][0-9])$" autocomplete="off" required=""/></td></tr></tbody></table>',$,_,V,p='<table class="flex justify-start" id="seg_imgs"><tbody><tr class="table_img"><td><img src="segment.jpg" alt="segment" id="seg_img1" height="100" width="100"/></td></tr> <tr class="table_p"><td>undefined</td></tr></tbody></table>',A,I,u,he="Launch SUMO",T,x,S="Export as JSON",ee,Q,qe="Reset Params",xe,ie,pe,te,Dt="Add Segment",ot,ge,Ot="Remove Segment",rt,We,it,X,Me,Vt="Outputs",at,ve,ze,be,Je,ut,ct,ne,ye,Te,Mt="Free-flow Speed (mi/hr):",dt,ht,we,Le,$t="Average Speed (mi/hr):",gt,mt,Ee,Pe,Rt="Percent followers in the <br/> analysis direction (%):",ft,_t,Ce,Se,Ft="Followers Density (followers/mi):",pt,vt,Be,ke,jt="Segment LOS:",bt,yt,He,Nt="Facility LOS:",wt,Ae,Ut="Facility Follower Density:",Et,De,qt="Error Message:",Ze,Ct,Wt,Oe=F(o[0]),D=[];for(let l=0;l<Oe.length;l+=1)D[l]=sn(ln(o,Oe,l));const pn=l=>fe(D[l],1,1,()=>{D[l]=null});let Ve=F(o[0]),O=[];for(let l=0;l<Ve.length;l+=1)O[l]=rn(tn(o,Ve,l));const vn=l=>fe(O[l],1,1,()=>{O[l]=null});ie=new Ln({props:{rows_len:o[0].length,rows:o[0]}});let $e=F(o[0]),N=[];for(let l=0;l<$e.length;l+=1)N[l]=an(en(o,$e,l));let Re=F(o[0]),U=[];for(let l=0;l<Re.length;l+=1)U[l]=un(Xt(o,Re,l));let Fe=F(o[0]),q=[];for(let l=0;l<Fe.length;l+=1)q[l]=cn(Qt(o,Fe,l));let je=F(o[0]),W=[];for(let l=0;l<je.length;l+=1)W[l]=dn(Kt(o,je,l));let Ne=F(o[0]),z=[];for(let l=0;l<Ne.length;l+=1)z[l]=hn(Gt(o,Ne,l));let Ue=F(o[0]),J=[];for(let l=0;l<Ue.length;l+=1)J[l]=gn(Yt(o,Ue,l));return{c(){e=c("div"),n=c("h1"),n.textContent=t,a=y(),m=c("label"),m.textContent=P,Y=y(),Z=c("input"),oe=y(),de=y(),k=c("form"),re=c("div"),G=c("table"),j=c("thead"),j.innerHTML=_e,K=y(),R=c("tbody");for(let l=0;l<D.length;l+=1)D[l].c();i=y(),E=c("div"),b=c("div"),b.innerHTML=H,$=y();for(let l=0;l<O.length;l+=1)O[l].c();_=y(),V=c("div"),V.innerHTML=p,A=y(),I=c("div"),u=c("button"),u.textContent=he,T=y(),x=c("a"),x.textContent=S,ee=y(),Q=c("button"),Q.textContent=qe,xe=y(),Pt(ie.$$.fragment),pe=y(),te=c("button"),te.textContent=Dt,ot=y(),ge=c("button"),ge.textContent=Ot,rt=y(),We=c("pre"),it=y(),X=c("div"),Me=c("h3"),Me.textContent=Vt,at=y(),ve=c("table"),ze=c("thead"),be=c("tr"),Je=c("th"),ut=y();for(let l=0;l<N.length;l+=1)N[l].c();ct=y(),ne=c("tbody"),ye=c("tr"),Te=c("th"),Te.textContent=Mt,dt=y();for(let l=0;l<U.length;l+=1)U[l].c();ht=y(),we=c("tr"),Le=c("th"),Le.textContent=$t,gt=y();for(let l=0;l<q.length;l+=1)q[l].c();mt=y(),Ee=c("tr"),Pe=c("th"),Pe.innerHTML=Rt,ft=y();for(let l=0;l<W.length;l+=1)W[l].c();_t=y(),Ce=c("tr"),Se=c("th"),Se.textContent=Ft,pt=y();for(let l=0;l<z.length;l+=1)z[l].c();vt=y(),Be=c("tr"),ke=c("th"),ke.textContent=jt,bt=y();for(let l=0;l<J.length;l+=1)J[l].c();yt=y(),He=c("p"),He.textContent=Nt,wt=y(),Ae=c("p"),Ae.textContent=Ut,Et=y(),De=c("p"),De.textContent=qt,this.h()},l(l){e=d(l,"DIV",{id:!0});var f=C(e);n=d(f,"H1",{class:!0,"data-svelte-h":!0}),M(n)!=="svelte-7db19c"&&(n.textContent=t),a=w(f),m=d(f,"LABEL",{"data-svelte-h":!0}),M(m)!=="svelte-18b90cm"&&(m.textContent=P),Y=w(f),Z=d(f,"INPUT",{type:!0,id:!0,accept:!0}),oe=w(f),de=w(f),k=d(f,"FORM",{id:!0,class:!0});var g=C(k);re=d(g,"DIV",{class:!0});var s=C(re);G=d(s,"TABLE",{class:!0});var L=C(G);j=d(L,"THEAD",{"data-svelte-h":!0}),M(j)!=="svelte-a8ya75"&&(j.innerHTML=_e),K=w(L),R=d(L,"TBODY",{});var zt=C(R);for(let B=0;B<D.length;B+=1)D[B].l(zt);zt.forEach(v),L.forEach(v),s.forEach(v),i=w(g),E=d(g,"DIV",{class:!0});var Ye=C(E);b=d(Ye,"DIV",{class:!0,"data-svelte-h":!0}),M(b)!=="svelte-ary4em"&&(b.innerHTML=H),$=w(Ye);for(let B=0;B<O.length;B+=1)O[B].l(Ye);Ye.forEach(v),_=w(g),V=d(g,"DIV",{class:!0,"data-svelte-h":!0}),M(V)!=="svelte-ogcc0f"&&(V.innerHTML=p),A=w(g),I=d(g,"DIV",{class:!0});var le=C(I);u=d(le,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),M(u)!=="svelte-1cpbuam"&&(u.textContent=he),T=w(le),x=d(le,"A",{class:!0,type:!0,id:!0,"data-svelte-h":!0}),M(x)!=="svelte-wstgn3"&&(x.textContent=S),ee=w(le),Q=d(le,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),M(Q)!=="svelte-1ptbqe4"&&(Q.textContent=qe),xe=w(le),St(ie.$$.fragment,le),pe=w(le),te=d(le,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),M(te)!=="svelte-1xthk90"&&(te.textContent=Dt),ot=w(le),ge=d(le,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),M(ge)!=="svelte-3g99z6"&&(ge.textContent=Ot),le.forEach(v),g.forEach(v),rt=w(f),We=d(f,"PRE",{id:!0}),C(We).forEach(v),it=w(f),X=d(f,"DIV",{class:!0});var ae=C(X);Me=d(ae,"H3",{"data-svelte-h":!0}),M(Me)!=="svelte-1erhcjg"&&(Me.textContent=Vt),at=w(ae),ve=d(ae,"TABLE",{class:!0});var Ge=C(ve);ze=d(Ge,"THEAD",{});var Jt=C(ze);be=d(Jt,"TR",{});var Ke=C(be);Je=d(Ke,"TH",{}),C(Je).forEach(v),ut=w(Ke);for(let B=0;B<N.length;B+=1)N[B].l(Ke);Ke.forEach(v),Jt.forEach(v),ct=w(Ge),ne=d(Ge,"TBODY",{});var ue=C(ne);ye=d(ue,"TR",{});var Qe=C(ye);Te=d(Qe,"TH",{id:!0,"data-svelte-h":!0}),M(Te)!=="svelte-hsq39t"&&(Te.textContent=Mt),dt=w(Qe);for(let B=0;B<U.length;B+=1)U[B].l(Qe);Qe.forEach(v),ht=w(ue),we=d(ue,"TR",{});var Xe=C(we);Le=d(Xe,"TH",{id:!0,"data-svelte-h":!0}),M(Le)!=="svelte-1q5b8il"&&(Le.textContent=$t),gt=w(Xe);for(let B=0;B<q.length;B+=1)q[B].l(Xe);Xe.forEach(v),mt=w(ue),Ee=d(ue,"TR",{});var et=C(Ee);Pe=d(et,"TH",{id:!0,"data-svelte-h":!0}),M(Pe)!=="svelte-1xzberj"&&(Pe.innerHTML=Rt),ft=w(et);for(let B=0;B<W.length;B+=1)W[B].l(et);et.forEach(v),_t=w(ue),Ce=d(ue,"TR",{});var tt=C(Ce);Se=d(tt,"TH",{id:!0,"data-svelte-h":!0}),M(Se)!=="svelte-79l5nu"&&(Se.textContent=Ft),pt=w(tt);for(let B=0;B<z.length;B+=1)z[B].l(tt);tt.forEach(v),vt=w(ue),Be=d(ue,"TR",{});var nt=C(Be);ke=d(nt,"TH",{id:!0,"data-svelte-h":!0}),M(ke)!=="svelte-t3rq9c"&&(ke.textContent=jt),bt=w(nt);for(let B=0;B<J.length;B+=1)J[B].l(nt);nt.forEach(v),ue.forEach(v),Ge.forEach(v),yt=w(ae),He=d(ae,"P",{id:!0,"data-svelte-h":!0}),M(He)!=="svelte-13z73v7"&&(He.textContent=Nt),wt=w(ae),Ae=d(ae,"P",{id:!0,"data-svelte-h":!0}),M(Ae)!=="svelte-zmd8y9"&&(Ae.textContent=Ut),Et=w(ae),De=d(ae,"P",{id:!0,"data-svelte-h":!0}),M(De)!=="svelte-4f23fz"&&(De.textContent=qt),ae.forEach(v),f.forEach(v),this.h()},h(){h(n,"class","text-3xl font-bold underline"),h(Z,"type","file"),h(Z,"id","jsonInput"),h(Z,"accept",".json"),h(G,"class","table w-full"),h(re,"class","w-full overflow-x-auto"),h(b,"class","parameters flex justify-start overflow-x-auto"),h(E,"class","grid auto-cols-max grid-flow-col md:grid-cols-2 sm:grid-cols-1 grid-cols-1"),h(V,"class","overflow-x-auto"),h(u,"class","btn"),h(u,"type","button"),h(x,"class","btn"),h(x,"type","submit"),h(x,"id","jsonOutput"),h(Q,"class","btn"),h(Q,"type","button"),h(te,"class","btn"),h(te,"type","button"),h(ge,"class","btn"),h(ge,"type","button"),h(I,"class","flex justify-end"),h(k,"id","hcm15"),h(k,"class","mt-4"),Cn(k,"submitted",On),h(We,"id","simulation-canvas"),h(Te,"id","ffs"),h(Le,"id","avgspd"),h(Pe,"id","pf"),h(Se,"id","fd"),h(ke,"id","seglos"),h(ve,"class","table w-full"),h(He,"id","los"),h(Ae,"id","fdF"),h(De,"id","error"),h(X,"class","los overflow-x-auto"),h(e,"id","hcm15-container")},m(l,f){Ie(l,e,f),r(e,n),r(e,a),r(e,m),r(e,Y),r(e,Z),r(e,oe),r(e,de),r(e,k),r(k,re),r(re,G),r(G,j),r(G,K),r(G,R);for(let g=0;g<D.length;g+=1)D[g]&&D[g].m(R,null);r(k,i),r(k,E),r(E,b),r(E,$);for(let g=0;g<O.length;g+=1)O[g]&&O[g].m(E,null);r(k,_),r(k,V),r(k,A),r(k,I),r(I,u),r(I,T),r(I,x),r(I,ee),r(I,Q),r(I,xe),kt(ie,I,null),r(I,pe),r(I,te),r(I,ot),r(I,ge),r(e,rt),r(e,We),r(e,it),r(e,X),r(X,Me),r(X,at),r(X,ve),r(ve,ze),r(ze,be),r(be,Je),r(be,ut);for(let g=0;g<N.length;g+=1)N[g]&&N[g].m(be,null);r(ve,ct),r(ve,ne),r(ne,ye),r(ye,Te),r(ye,dt);for(let g=0;g<U.length;g+=1)U[g]&&U[g].m(ye,null);r(ne,ht),r(ne,we),r(we,Le),r(we,gt);for(let g=0;g<q.length;g+=1)q[g]&&q[g].m(we,null);r(ne,mt),r(ne,Ee),r(Ee,Pe),r(Ee,ft);for(let g=0;g<W.length;g+=1)W[g]&&W[g].m(Ee,null);r(ne,_t),r(ne,Ce),r(Ce,Se),r(Ce,pt);for(let g=0;g<z.length;g+=1)z[g]&&z[g].m(Ce,null);r(ne,vt),r(ne,Be),r(Be,ke),r(Be,bt);for(let g=0;g<J.length;g+=1)J[g]&&J[g].m(Be,null);r(X,yt),r(X,He),r(X,wt),r(X,Ae),r(X,Et),r(X,De),Ze=!0,Ct||(Wt=[ce(Z,"change",o[9]),ce(u,"click",o[1]),ce(x,"click",o[10]),ce(x,"change",o[10]),ce(Q,"click",Mn),ce(te,"click",o[2]),ce(ge,"click",o[3]),ce(k,"submit",Bn(o[8]))],Ct=!0)},p(l,f){if(f[0]&49){Oe=F(l[0]);let s;for(s=0;s<Oe.length;s+=1){const L=ln(l,Oe,s);D[s]?(D[s].p(L,f),se(D[s],1)):(D[s]=sn(L),D[s].c(),se(D[s],1),D[s].m(R,null))}for(xt(),s=Oe.length;s<D.length;s+=1)pn(s);It()}if(f[0]&193){Ve=F(l[0]);let s;for(s=0;s<Ve.length;s+=1){const L=tn(l,Ve,s);O[s]?(O[s].p(L,f),se(O[s],1)):(O[s]=rn(L),O[s].c(),se(O[s],1),O[s].m(E,null))}for(xt(),s=Ve.length;s<O.length;s+=1)vn(s);It()}const g={};if(f[0]&1&&(g.rows_len=l[0].length),f[0]&1&&(g.rows=l[0]),ie.$set(g),f[0]&1){$e=F(l[0]);let s;for(s=0;s<$e.length;s+=1){const L=en(l,$e,s);N[s]?N[s].p(L,f):(N[s]=an(L),N[s].c(),N[s].m(be,null))}for(;s<N.length;s+=1)N[s].d(1);N.length=$e.length}if(f[0]&1){Re=F(l[0]);let s;for(s=0;s<Re.length;s+=1){const L=Xt(l,Re,s);U[s]?U[s].p(L,f):(U[s]=un(L),U[s].c(),U[s].m(ye,null))}for(;s<U.length;s+=1)U[s].d(1);U.length=Re.length}if(f[0]&1){Fe=F(l[0]);let s;for(s=0;s<Fe.length;s+=1){const L=Qt(l,Fe,s);q[s]?q[s].p(L,f):(q[s]=cn(L),q[s].c(),q[s].m(we,null))}for(;s<q.length;s+=1)q[s].d(1);q.length=Fe.length}if(f[0]&1){je=F(l[0]);let s;for(s=0;s<je.length;s+=1){const L=Kt(l,je,s);W[s]?W[s].p(L,f):(W[s]=dn(L),W[s].c(),W[s].m(Ee,null))}for(;s<W.length;s+=1)W[s].d(1);W.length=je.length}if(f[0]&1){Ne=F(l[0]);let s;for(s=0;s<Ne.length;s+=1){const L=Gt(l,Ne,s);z[s]?z[s].p(L,f):(z[s]=hn(L),z[s].c(),z[s].m(Ce,null))}for(;s<z.length;s+=1)z[s].d(1);z.length=Ne.length}if(f[0]&1){Ue=F(l[0]);let s;for(s=0;s<Ue.length;s+=1){const L=Yt(l,Ue,s);J[s]?J[s].p(L,f):(J[s]=gn(L),J[s].c(),J[s].m(Be,null))}for(;s<J.length;s+=1)J[s].d(1);J.length=Ue.length}},i(l){if(!Ze){for(let f=0;f<Oe.length;f+=1)se(D[f]);for(let f=0;f<Ve.length;f+=1)se(O[f]);se(ie.$$.fragment,l),Ze=!0}},o(l){D=D.filter(Boolean);for(let f=0;f<D.length;f+=1)fe(D[f]);O=O.filter(Boolean);for(let f=0;f<O.length;f+=1)fe(O[f]);fe(ie.$$.fragment,l),Ze=!1},d(l){l&&v(e),me(D,l),me(O,l),Ht(ie),me(N,l),me(U,l),me(q,l),me(W,l),me(z,l),me(J,l),Ct=!1,mn(Wt)}}}let On=!1;function _n(o){var e=document.getElementById("seg_imgs"),n=e.rows[1],t="undefined",a=document.getElementById("seg_img"+o),m=document.getElementById("vi_input"+o),P=document.getElementById("vo_input"+o),Y=document.getElementById("passing_type"+o).value;Y=="Passing Zone"?(m.value="1000",P.value="0",a.src="PassingZone.png",a.height=100,a.width=100,a.parentNode.width=100,t="Passing Zone"):Y=="Passing Constrained"?(a.src="PassingConstrained.png",m.value="1000",P.value="1500",a.height=100,a.width=100,a.parentNode.width=100,t="Passing Constrained"):Y=="Passing Lane"&&(a.src="PassingLane.png",m.value="1000",P.value="0",a.height=100,a.width=150,a.parentNode.width=150,t="Passing Lane"),n.cells[o-1].innerHTML=t}function Vn(o){const e=new FileReader;return new Promise((n,t)=>{e.onload=()=>n(JSON.parse(e.result)),e.onerror=t,e.readAsText(o)})}function Mn(){window.location.reload()}function $n(o,e,n){yn(async()=>{await Pn()});let{rows:t}=e,{subrows:a}=e,m=-1;a=[{subseg_num:1}],t=[{seg_num:1,subrows:a}];async function P(){let i=new Array(t.length),E=new Array(t.length),b=new Array(t.length),H=new Array(t.length),$=new Array(t.length),_=new Array(t.length),V=new Array(t.length),p=new Array(t.length);for(var A=0;A<t.length;A++)b[A]=new Array(t[A].subrows.length+1),H[A]=new Array(t[A].subrows.length+1);console.log(t.length);for(let u=0;u<t.length;u++){let he=document.getElementById("passing_type"+(u+1)),T=he.options[he.selectedIndex].text;i[u]=document.getElementById("seg_length"+(u+1)).value,E[u]=0,T=="Passing Lane"?V[u]=2:V[u]=1,$[u]=document.getElementById("seg_Spl"+(u+1)).value,_=document.getElementById("LW_input").value,p[u]=document.getElementById("vi_input"+(u+1)).value}const I=At.sidecar("../sim-coordination/sumo/make_netfile",["--root_dir ../sim-coordination/sumo","--segment_num "+t.length,"--subsegment_num "+a.length,"--seg_x ["+i.toString()+"]","--seg_y ["+E.toString()+"]","--num_lanes ["+V+"]","--speed ["+$+"]","--lane_width "+_]);console.log(I),I.execute()}function Y(){n(0,t=[...t,{seg_num:t.length+1,subrows:a}]);var i=document.getElementById("seg_imgs"),E=i.rows[0],b=i.rows[1],H=document.createElement("img");if(H.src="segment.jpg",H.height=100,H.width=100,H.setAttribute("id","seg_img"+t.length),document.getElementById("passing_type"+t.length)!=null)var $=document.getElementById("passing_type"+t.length).value;E.insertCell(-1).appendChild(H),b.insertCell(-1).innerHTML=$}function Z(){var i=document.getElementById("seg_imgs"),E=document.getElementById("seg_img"+t.length),b=i.rows[0],H=i.rows[1];t.length>1&&(E!=null&&b.deleteCell(-1),H.length==b.length&&H.deleteCell(-1),n(0,t=t.slice(0,t.length-1)))}function oe(i){var E=document.getElementById("hc_param"+i),b=document.getElementById("hc_table"+i);E.checked?m==-1?(b.style.display="block",m=i):console.log("Cannot toggle more than one"):m==i&&(b.style.display="none",m=-1)}function de(i,E){var b=document.getElementById("is_hc"+i),H=document.getElementById("hc_param"+i),$=document.getElementById("hc_table"+i);document.getElementsByClassName("design_radius"+E),b.checked&&(H.checked=!0,oe(i)),b.checked||m==i&&($.style.display="none",m=-1,H.checked=!1)}function k(i){var E=[...t[i-1].subrows,{subseg_num:t[i-1].subrows.length+1}];n(0,t[i-1]={seg_num:i,subrows:E},t)}function re(i){t[i-1].subrows.length>1&&n(0,t[i-1].subrows=t[i-1].subrows.slice(0,t[i-1].subrows.length-1),t)}function G(i){setTimeout(function(){},4e3)}let j;async function _e(i){const E=i.target.files[0];if(E==null){j=null;return}j=await Vn(E),K(j)}async function K(i){let E=i.lane_width,b=i.shoulder_width,H=i.apd,$=i.pmhvfl;document.getElementById("LW_input").value=E,document.getElementById("SW_input").value=b,document.getElementById("APD_input").value=H,document.getElementById("PMHVFL_input").value=$;for(let _=0;_<i.segments.length;_++)_!=0&&Y(),setTimeout(function(){const V=document.getElementById("passing_type"+(_+1));V.options.item(i.segments[_].passing_type+1).selected=!0,_n(_+1),document.getElementById("seg_length"+(_+1)).value=i.segments[_].length,document.getElementById("seg_grade"+(_+1)).value=i.segments[_].grade,document.getElementById("seg_Spl"+(_+1)).value=i.segments[_].spl,document.getElementById("is_hc"+(_+1)).checked=i.segments[_].is_hc,document.getElementById("vi_input"+(_+1)).value=i.segments[_].volume,document.getElementById("vo_input"+(_+1)).value=i.segments[_].volume_op,document.getElementById("vc_select"+(_+1)).options.item(i.segments[_].vertical_class-1).selected=!0,document.getElementById("PHF_input"+(_+1)).value=i.segments[_].phf,document.getElementById("PHV_input"+(_+1)).value=i.segments[_].phv;var p=document.getElementById("hc_table"+(_+1));p.style.display="none",m=-1;for(let A=0;A<i.segments[_].subsegments.length;A++)A!=0&&k(_+1),setTimeout(function(){document.getElementById("hc_table"+(_+1)).getElementsByClassName("subseg_len"+(A+1))[0].value=i.segments[_].subsegments[A].length,document.getElementById("hc_table"+(_+1)).getElementsByClassName("design_radius"+(A+1))[0].value=i.segments[_].subsegments[A].design_rad,document.getElementById("hc_table"+(_+1)).getElementsByClassName("superelevation"+(A+1))[0].value=i.segments[_].subsegments[A].sup_ele},10)},10)}function R(){const i={segments:[],lane_width:0,shoulder_width:0,apd:0,pmhvfl:0,l_de:0};i.lane_width=document.getElementById("LW_input").value,i.shoulder_width=document.getElementById("SW_input").value,i.apd=document.getElementById("APD_input").value,i.pmhvfl=document.getElementById("PMHVFL_input").value;let E=t.length;for(let p=0;p<E;p++){const A={passing_type:0,length:0,grade:0,spl:0,is_hc:!1,volume:0,volume_op:0,flow_rate:0,flow_rate_o:0,capacity:0,ffs:0,avg_speed:0,vertical_class:1,subsegments:[],phf:0,phv:0,pf:0,fd:0,fd_mid:0,hor_class:0};let I=t[p].subrows.length;var b=document.getElementById("passing_type"+(p+1)),H=b.options[b.selectedIndex].text;H=="Passing Constrained"?b=0:H=="Passing Zone"?b=1:H=="Passing Lane"&&(b=2);var $=document.getElementById("vc_select"+(p+1));i.segments.push(A),i.segments[p].passing_type=b,i.segments[p].length=document.getElementById("seg_length"+(p+1)).value,i.segments[p].grade=document.getElementById("seg_grade"+(p+1)).value,i.segments[p].spl=document.getElementById("seg_Spl"+(p+1)).value,i.segments[p].is_hc=document.getElementById("is_hc"+(p+1)).checked,i.segments[p].volume=document.getElementById("vi_input"+(p+1)).value,i.segments[p].volume_op=document.getElementById("vo_input"+(p+1)).value,i.segments[p].vertical_class=$.options[$.selectedIndex].text,i.segments[p].phf=document.getElementById("PHF_input"+(p+1)).value,i.segments[p].phv=document.getElementById("PHV_input"+(p+1)).value,console.log(I);for(let u=0;u<I;u++){const he={length:0,avg_speed:0,hor_class:0,design_rad:0,sup_ele:0};i.segments[p].subsegments.push(he),i.segments[p].subsegments[u].length=document.getElementById("hc_table"+(p+1)).getElementsByClassName("subseg_len"+(u+1))[0].value,i.segments[p].subsegments[u].design_rad=document.getElementById("hc_table"+(p+1)).getElementsByClassName("design_radius"+(u+1))[0].value,i.segments[p].subsegments[u].sup_ele=document.getElementById("hc_table"+(p+1)).getElementsByClassName("superelevation"+(u+1))[0].value}}const _="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(i)),V=document.getElementById("jsonOutput");V.setAttribute("href",_),V.setAttribute("download","hcm15_output.json")}return o.$$set=i=>{"rows"in i&&n(0,t=i.rows),"subrows"in i&&n(11,a=i.subrows)},[t,P,Y,Z,oe,de,k,re,G,_e,R,a]}class Wn extends wn{constructor(e){super(),En(this,e,$n,Dn,bn,{rows:0,subrows:11},null,[-1,-1])}}export{Wn as component};
